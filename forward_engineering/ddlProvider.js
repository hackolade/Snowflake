"use strict";var En=Object.defineProperty;var n=(r,i)=>En(r,"name",{value:i,configurable:!0});var W=(r,i)=>()=>(i||r((i={exports:{}}).exports,i),i.exports);var tt=W((mr,et)=>{"use strict";et.exports={number:"NUMBER",string:"VARCHAR",date:"DATE",timestamp:"TIMESTAMP",binary:"BINARY",boolean:"BOOLEAN",document:"OBJECT",array:"ARRAY",objectId:"VARCHAR(24)",default:"CHAR"}});var rt=W((Er,nt)=>{"use strict";nt.exports={NUMBER:{capacity:12,mode:"decimal"},DECIMAL:{capacity:12,mode:"decimal"},NUMERIC:{capacity:12,mode:"decimal"},INT:{capacity:4},INTEGER:{capacity:4},BIGINT:{capacity:8},BYTEINT:{capacity:1},TINYINT:{capacity:1},SMALLINT:{capacity:2},REAL:{capacity:4,mode:"floating"},FLOAT:{capacity:8,mode:"floating"},FLOAT4:{capacity:4,mode:"floating"},FLOAT8:{capacity:8,mode:"floating"},DOUBLE:{capacity:8,mode:"floating"},"DOUBLE PRECISION":{capacity:8,mode:"floating"},VARCHAR:{mode:"varying"},CHAR:{size:1},CHARACTER:{size:1},STRING:{mode:"varying"},TEXT:{mode:"text"},BINARY:{size:8e3,mode:"binary"},VARBINARY:{size:8e3,mode:"binary"},BOOLEAN:{mode:"boolean"},DATE:{format:"YYYY-MM-DD"},DATETIME:{format:"YYYY-MM-DD hh:mm:ss.nn"},TIME:{format:"hh:mm:ss"},TIMESTAMP:{format:"YYYY-MM-DD hh:mm:ss"},TIMESTAMP_LTZ:{format:"YYYY-MM-DD hh:mm:ss.nnnnnnZ"},TIMESTAMPLTZ:{format:"YYYY-MM-DD hh:mm:ss.nnnnnnZ"},TIMESTAMP_NTZ:{format:"YYYY-MM-DD hh:mm:ss.nnn"},TIMESTAMPNTZ:{format:"YYYY-MM-DD hh:mm:ss.nnn"},"TIMESTAMP WITHOUT TIME ZONE":{format:"YYYY-MM-DD hh:mm:ss.nnn"},TIMESTAMP_TZ:{format:"YYYY-MM-DD hh:mm:ss"},TIMESTAMPTZ:{format:"YYYY-MM-DD hh:mm:ss"},"TIMESTAMP WITH LOCAL TIME ZONE":{format:"YYYY-MM-DD hh:mm:ss"},"TIMESTAMP WITH TIME ZONE":{format:"YYYY-MM-DD hh:mm:ss"},VARIANT:{format:"semi-structured"},OBJECT:{format:"semi-structured",mode:"object"},ARRAY:{format:"semi-structured",mode:"array"},GEOGRAPHY:{mode:"geography"}}});var Ye=W((Tr,st)=>{"use strict";st.exports={createDatabase:"CREATE DATABASE IF NOT EXISTS ${name};\nUSE DATABASE ${name};\n",createSchema:"CREATE${transient} SCHEMA IF NOT EXISTS ${name}${managed_access}${data_retention}${comment};\nUSE SCHEMA ${name};\n",dropSchema:"DROP SCHEMA IF EXISTS ${name};\n",createTable:"CREATE${orReplace}${temporary}${transient} TABLE${tableIfNotExists}\n	${name} (\n		${column_definitions}${out_of_line_constraints}\n	)${tableOptions};\n",createDynamicTable:"CREATE${orReplace}${transient}${dynamic}${iceberg} TABLE${tableIfNotExists}\n	${name}\n${column_definitions}${targetLag}${warehouse}${externalVolume}${catalog}${baseLocation}${refreshMode}${initialize}${clusterKeys}${dataRetentionTime}${maxDataExtensionTime}${copyGrants}${comment}${tagsStatement}${selectStatement};\n",createLikeTable:"CREATE TABLE IF NOT EXISTS ${name} LIKE ${source_table}${tableOptions};\n",createCloneTable:"CREATE TABLE IF NOT EXISTS ${name} CLONE ${source_table}${tableOptions};\n",createAsSelect:"CREATE TABLE IF NOT EXISTS ${name} AS ${selectStatement}${tableOptions};\n",createExternalTable:"CREATE${orReplace} EXTERNAL TABLE${tableIfNotExists}\n	${name} (\n		${column_definitions}${out_of_line_constraints}\n	)${tableOptions};\n",columnDefinition:"${name} ${type}${collation}${default}${identity}${autoincrement}${not_nul}${inline_constraint}${comment}${tag}",externalColumnDefinition:"${name} ${type} as ${expression}${comment}",createTableForeignKey:"${constraint}FOREIGN KEY (${columns}) REFERENCES ${primary_table} (${primary_columns})",alterTableForeignKey:"ALTER TABLE IF EXISTS ${table_name} ADD ${constraint}FOREIGN KEY (${columns}) REFERENCES ${primary_table} (${primary_columns});",createView:"CREATE${secure}${materialized} VIEW IF NOT EXISTS ${name} (\n	${column_list}\n)\n${copy_grants}${comment}${tag}${clustering}AS ${select_statement};\n",createUDF:"CREATE${orReplace} FUNCTION ${name}(${arguments})\n	RETURNS ${returnType}${notNull}\n	LANGUAGE ${language}${parameters}${comment}\n	AS ${body};\n",createProcedure:"CREATE${orReplace} PROCEDURE ${name}(${arguments})\n	RETURNS ${returnType}${notNull}\n	LANGUAGE ${language}${parameters}${comment}\n	AS ${body};\n",createSequence:"CREATE SEQUENCE IF NOT EXISTS ${name} START ${start} INCREMENT ${increment}${comment};\n",createFileFormat:"CREATE FILE FORMAT IF NOT EXISTS ${name}${options}${comment};\n",createStage:"CREATE${temporary} STAGE IF NOT EXISTS ${name} ${url}${storageIntegration}${credentials}${encryption};\n",alterSchema:"ALTER SCHEMA IF EXISTS ${name} ${operation} ${options};",alterTable:"ALTER${dynamic} TABLE IF EXISTS ${name} ${action};",alterView:"ALTER${materialized} VIEW IF EXISTS ${name} ${action};",alterSchemaScript:"ALTER SCHEMA IF EXISTS ${name} ",alterTableScript:"ALTER${dynamic} TABLE IF EXISTS ${name} ",alterEntityRename:"RENAME TO ${name};\n",alterViewScript:"ALTER VIEW IF EXISTS ${name} ",alterMaterializedViewScript:"ALTER MATERIALIZED VIEW ${name} ",setPropertySchema:"SET ${property};\n",unsetPropertySchema:"UNSET ${property};\n",setPropertyTable:"SET ${property};\n",manageAccessSchema:"${access} MANAGED ACCESS;\n",createTag:"CREATE${orReplace} TAG${ifNotExist} ${name}${allowedValues}${comment};\n",dropTag:"DROP TAG IF EXISTS ${name};\n",alterTag:"ALTER TAG${ifExists} ${name} ${option}${optionValue};\n"}});var ve=W((ur,it)=>{"use strict";var Tn=["DROP SCHEMA","DROP TABLE","DROP COLUMN","DROP VIEW","DROP TAG"],un={JAVA:"java",JAVASCRIPT:"javascript",PYTHON:"python",SCALA:"scala",SQL:"sql"},ln={SNOWSIGHT:"snowSight",CLASSIC_UI:"classicUI"};it.exports={DROP_STATEMENTS:Tn,LANGUAGES:un,FORMATS:ln}});var ct=W((lr,ot)=>{"use strict";var pn=require("lodash"),at={ON_ERROR:"ABORT_STATEMENT",SIZE_LIMIT:null,PURGE:!0,RETURN_FAILED_ONLY:!1,MATCH_BY_COLUMN_NAME:"none",ENFORCE_LENGTH:!0,TRUNCATECOLUMNS:!1,FORCE:!1},An=n((r={},i={},t=[])=>t.reduce((a,T)=>pn.isEqual(r[T],i[T])?a:!i[T]&&r[T]!==at[T]?{...a,[T]:at[T]}:i[T]?{...a,[T]:i[T]}:a,{}),"getDiffCopyOptionsByDefault");ot.exports={getDiffCopyOptionsByDefault:An}});var pt=W((Ar,lt)=>{"use strict";var xe=require("lodash"),{getDiffCopyOptionsByDefault:Nn}=ct(),mt=["description","DATA_RETENTION_TIME_IN_DAYS","MAX_DATA_EXTENSION_TIME_IN_DAYS"],Et=["targetLag","warehouse","DATA_RETENTION_TIME_IN_DAYS","MAX_DATA_EXTENSION_TIME_IN_DAYS","description"],Sn=xe.uniq([...mt,...Et]),yn=["id"],dn=n((r,i)=>i.some(t=>(r==null?void 0:r.oldField[t])!==(r==null?void 0:r.newField[t])),"checkFieldPropertiesChanged"),gn=n(r=>({udfs:r.UDFs,sequences:r.sequences,fileFormats:r.fileFormats}),"prepareContainerLevelData"),In=n((r,i,t)=>{let{schemaName:a,databaseName:T}=Tt(r,i),u=i(r.isCaseSensitive,t(r));return{schemaName:a,databaseName:T,tableName:u}},"getNames"),Tt=n((r,i)=>{var l;let{database:t,isCaseSensitive:a}=((l=r.compMod)==null?void 0:l.bucketProperties)||{},{keyspaceName:T}=r.compMod,u=i(a,T),R=i(a,t);return{schemaName:u,databaseName:R}},"getBaseAndContainerNames"),Rn=n(({collection:r,data:i})=>{let{database:t}=(r==null?void 0:r.role)||{};return i={...i,nameData:{...i.nameData||{},database:t}},{collection:r,data:i}},"prepareContainerName"),Cn=n(({collection:r,data:i})=>{var a,T,u;let t=((a=r==null?void 0:r.role)==null?void 0:a.compMod)||{};return i={...i,nameData:{...i.nameData||{},isExternal:(T=r==null?void 0:r.role)==null?void 0:T.external,database:(u=t==null?void 0:t.bucketProperties)==null?void 0:u.database,schemaName:t==null?void 0:t.keyspaceName}},{collection:r,data:i}},"prepareTableName"),On=n((r={})=>{let i=r.code,t=r.name||r.collectionName;return{oldName:(i==null?void 0:i.old)||(t==null?void 0:t.old),newName:(i==null?void 0:i.new)||(t==null?void 0:t.new)}},"setName"),_n=n(({collection:r,data:i})=>{let{compMod:t,isCaseSensitive:a,name:T,code:u,materialized:R}=(r==null?void 0:r.role)||{},l=On(t),w=(l==null?void 0:l.newName)!==(l==null?void 0:l.oldName);return i={...i,nameData:{...i.nameData||{},isCaseSensitive:a,nameIsChanged:w,isMaterialized:R,newName:(l==null?void 0:l.newName)||u||T,oldName:l==null?void 0:l.oldName}},{collection:r,data:i}},"prepareName"),fn=n(({collection:r,data:i})=>{let{compMod:t}=(r==null?void 0:r.role)||{},a=Sn.reduce((T,u)=>{let{new:R,old:l}=(t==null?void 0:t[u])||{};return l!==R?R&&Et.includes(u)?{...T,set:{...T.set,[u]:R}}:l&&mt.includes(u)?{...T,unset:[...T.unset,u]}:T:T},{set:{},unset:[]});return{collection:r,data:{...i,setProperty:a.set,unsetProperty:a.unset}}},"prepareAlterSetUnsetData"),$n=n(({collection:r,data:i})=>{var T,u;let t=(u=(T=r==null?void 0:r.role)==null?void 0:T.compMod)==null?void 0:u.managedAccess,a=t&&(t==null?void 0:t.new)!==(t==null?void 0:t.old);return{collection:r,data:{...i,managedAccess:{isChange:a,value:!!(t!=null&&t.new)}}}},"prepareMenageContainerData"),Mn=n(({collection:r,data:i})=>{let t=(r==null?void 0:r.role)||{},a=t.compMod||{},{new:T,old:u}=a.fileFormat||{},{new:R,old:l}=a.customFileFormatName||{};return{collection:r,data:{...i,formatData:{isChangeCustomFileFormat:(R||l)&&R!==l,isChangeType:(T||u)&&T!==u,fileFormat:T||(t==null?void 0:t.fileFormat),formatName:R}}}},"prepareCollectionFileFormat"),ut=n((r={},i={})=>{let t=Object.keys(r),a=Object.keys(i);return xe.union(t,a).filter(T=>!yn.includes(T))},"getObjectCommonKeys"),Ln=n(({collection:r,data:i})=>{var R,l;let{new:t={},old:a={}}=((l=(R=r==null?void 0:r.role)==null?void 0:R.compMod)==null?void 0:l.formatTypeOptions)||{},u=ut(a,t).some(w=>!xe.isEqual(t[w],a[w]));return{collection:r,data:{...i,formatTypeOptions:{optionsIsChanged:u,typeOptions:t}}}},"prepareCollectionFormatTypeOptions"),Pn=n((r,i,t)=>({collection:a,data:T})=>{var p,O;let{new:u={},old:R={}}=((O=(p=a==null?void 0:a.role)==null?void 0:p.compMod)==null?void 0:O.stageCopyOptions)||{},l=ut(R,u),w=l.some(h=>!t.isEqual(u[h],R[h])),B=Nn(R,u,l);B={...B,sizeLimit:t.has(B,"SIZE_LIMIT")};let Y={optionsIsChanged:w,options:r(i(B))};return{collection:a,data:{...T,stageCopyOptions:Y}}},"prepareCollectionStageCopyOptions");lt.exports={checkFieldPropertiesChanged:dn,prepareContainerLevelData:gn,getBaseAndContainerNames:Tt,getNames:In,prepareTableName:Cn,prepareContainerName:Rn,prepareName:_n,prepareAlterSetUnsetData:fn,prepareMenageContainerData:$n,prepareCollectionFileFormat:Mn,prepareCollectionFormatTypeOptions:Ln,prepareCollectionStageCopyOptions:Pn}});var ye=W((Sr,At)=>{"use strict";var{FORMATS:Fn}=ve(),Kn=/(\\r|\\n|\\b|\\f|\\t|'|"|\\[0-9]{3}|\0|\\x5C[0-3]?[0-7]{1,2}|\x5C[xX][0-9A-Fa-f]{2}|\x5C[uU][0-9A-Fa-f]{4}|\\)/g,Un=n((r,i)=>r===Fn.SNOWSIGHT?`'${i.replace(Kn,"\\$1")}'`:`$$${i}$$`,"escapeString");At.exports={escapeString:Un}});var St=W((dr,Nt)=>{"use strict";var bn=n(({index:r,numberOfStatements:i,lastIndexOfActivatedStatement:t,delimiter:a})=>{let T=r===i-1,u=r===t;return T?"":u?" //"+a:a},"getDelimiter"),hn=n(({statements:r=[],delimiter:i=",",indent:t=`
`})=>{let a=r.findLastIndex(u=>!u.startsWith("//")),T=r.length;return r.map((u,R)=>{let l=bn({index:R,numberOfStatements:T,lastIndexOfActivatedStatement:a,delimiter:i});return u+l}).join(t)},"joinActivatedAndDeactivatedStatements");Nt.exports={joinActivatedAndDeactivatedStatements:hn}});var me=W((Ir,yt)=>{"use strict";var Yn=n(r=>r?` ${r}`:"","preSpace");yt.exports={preSpace:Yn}});var It=W((Cr,gt)=>{"use strict";var dt=n((r="")=>new RegExp("\\$\\{(.*?)}",r),"template"),vn=n(r=>r.match(dt("gi"))||[],"getAllTemplates"),xn=n(r=>(r.match(dt("i"))||[])[1],"parseTemplate"),Bn=n((r,i)=>vn(r).reduce((t,a)=>{let T=xn(a);return t.replace(a,()=>i[T]||i[T]===0?i[T]:"")},r),"assignTemplates");gt.exports=Bn});var Be=W((_r,Rt)=>{"use strict";var qn=require("lodash"),Vn=["//"],Gn=n((r,i,t)=>qn.has(i,"isActivated")&&!i.isActivated?t?"// "+r:r.includes(`
`)?r.split(`
`).filter(Boolean).map(a=>"// "+a).join(`
`).concat(`
`):r?"// "+r:"":r,"commentIfDeactivated"),wn=n((r="")=>Vn.some(i=>r.startsWith(i)),"queryIsDeactivated");Rt.exports={commentIfDeactivated:Gn,queryIsDeactivated:wn}});var oe=W(($r,Ct)=>{"use strict";var Q=require("lodash"),Dn=It(),{commentIfDeactivated:de}=Be();Ct.exports=r=>{let{checkAllKeysActivated:i}=r.require("@hackolade/ddl-fe-utils").general,t=n(s=>String(s).replace(/'/g,"''").replace(/\\\\/g,"\\").replace(/\\/g,"\\\\"),"escape"),a=n(s=>Q.isUndefined(s)?s:`'${t(s)}'`,"toString"),T=n(s=>Q.toLower(s)==="none","isNone"),u=n(s=>Q.toLower(s)==="auto","isAuto"),R=n(s=>T(s)?s:a(s),"toStringIfNotNone"),l=n(s=>u(s)?s:a(s),"toStringIfNotAuto"),w=n(s=>isNaN(s)?"":Number(s),"toNumber"),B=n(s=>s===!0?"TRUE":void 0,"toBoolean"),Y=n(s=>Object.entries(s).filter(([S,C])=>!Q.isEmpty(C)||C!==!1).map(([S,C])=>(Array.isArray(C)&&(C="("+C.filter(M=>!Q.isEmpty(M)).join(", ")+")"),`${S}=${C}`)).join(`
`),"toOptions"),p=n((s,S,C)=>{if(S.GUID===s)return[{...S,name:C}];if(Q.isPlainObject(S.properties)){let M=Object.keys(S.properties).reduce((L,H)=>{if(L.length)return L;let D=p(s,S.properties[H],H);return D?L.concat(D):L},[]);if(M.length)return[{...S,name:C}].concat(M)}else if(Q.isArray(S.items)){let M=S.items.reduce((L,H)=>{if(L.length)return L;let D=p(s,H,"");return D?L.concat(D):L},[]);if(M.length)return[{...S,name:C}].concat(M)}else if(S.items){let M=p(s,S.items,"");if(M)return[{...S,name:C}].concat(M)}},"findJsonSchemaChain"),O=n((s,S,C)=>{let M=Q.get(C,"clusteringKey[0].name",""),L=Q.get(C,"clusteringKey[0].isActivated",!0),H=n(D=>String(D||"").includes("."),"isComplexName");if(C.expression)return{name:Dn(C.expression,{name:F(s,M)}),isActivated:L,isExpression:!0};if(M&&!H(M))return{name:M,isActivated:L};{let D=Q.get(C,"clusteringKey[0].keyId",""),J=p(D,S);if(Array.isArray(J)){let Te=Q.get(J[J.length-1],"type","").replace(/json/i,"").toLowerCase();return{name:`(${J.map(pe=>F(s,pe.name)).filter(Boolean).join(":")}::${Te})`,isActivated:L,isExpression:!0}}}},"composeClusteringKey"),h=n((s,S)=>{if(Array.isArray(S)){let C=", ",M=[],L=S.reduce((H,D)=>{let J=Q.isString(D.name)?D.name.trim():D.trim();return D.isExpression||(J=F(s,J)),Q.get(D,"isActivated",!0)?[...H,J]:(M.push(J),H)},[]).filter(Boolean);return L.length===0?de(M.join(C),{isActivated:!1},!0):M.length===0?L.join(C):L.join(C)+de(C+M.join(C),{isActivated:!1},!0)}return S},"foreignKeysToString"),N=n((s,S)=>S==null?void 0:S.map(C=>F(s,C.name.trim())).join(", "),"foreignActiveKeysToString"),c=n(s=>i(s.foreignKey)&&i(s.primaryKey)&&s.primaryTableActivated&&s.foreignTableActivated,"checkIfForeignKeyActivated"),g=n((s,S)=>{if(!S)return s.map(L=>L.name).join(`,
	`);let C=s.filter(L=>L.isActivated).map(L=>L.name),M=s.filter(L=>!L.isActivated).map(L=>L.name);return C.length===0?de(M.join(`,
	`),{isActivated:!1},!0):M.length===0?C.join(`,
	`):C.join(`,
	`)+`
	`+de(M.join(`,
	`),{isActivated:!1},!0)},"viewColumnsToString"),F=n((s,S)=>S&&(s?$(S):y(S)?S:$(S)),"getName"),_=n(s=>s&&(s.code||s.collectionName)||"","getEntityName"),I=n((s,S)=>s?`${s}.${S}`:S,"getFullName"),y=n(s=>/^[a-z_][a-z\d_$]*$/i.test(s),"isValidCaseInsensitiveName"),$=n(s=>/^".*"$/.test(s)?s:`"${s}"`,"addQuotes");return{escape:t,toString:a,isNone:T,isAuto:u,toStringIfNotNone:R,toStringIfNotAuto:l,toNumber:w,toBoolean:B,toOptions:Y,composeClusteringKey:O,foreignKeysToString:h,checkIfForeignKeyActivated:c,foreignActiveKeysToString:N,viewColumnsToString:g,getName:F,getEntityName:_,getFullName:I,getDbName:n(s=>Q.get(s,"code")||Q.get(s,"name",""),"getDbName"),addQuotes:$,getGroupItemsByCompMode:n(({newItems:s=[],oldItems:S=[]})=>{let C=s.filter(H=>!S.some(D=>D.id===H.id)),M=[],L=[];return S.forEach(H=>{let D=s.find(J=>J.id===H.id);D?Q.isEqual(D,H)||L.push(D):M.push(H)}),{added:C,removed:M,modified:L}},"getGroupItemsByCompMode")}}});var _t=W((Lr,Ot)=>{"use strict";var ie=require("lodash");Ot.exports=r=>{let{clean:i}=r.require("@hackolade/ddl-fe-utils").general,{addQuotes:t}=oe()(r),a=n((c,g)=>Object.entries(c.properties).map(g),"mapProperties"),T=n(c=>!(c.compositeUniqueKey||!c.unique),"isUniqueKey"),u=n(c=>!(c.compositeUniqueKey||c.compositePrimaryKey||!c.primaryKey),"isPrimaryKey"),R=n((c,g,F,_)=>i({keyType:"UNIQUE",name:c.constraintName,columns:[{name:g,isActivated:F}],include:Y(c.include||c.indexInclude||[],_),storageParameters:c.indexStorageParameters,comment:c.indexComment,tablespace:c.indexTablespace}),"hydrateUniqueOptions"),l=n((c,g,F,_)=>i({keyType:"PRIMARY KEY",name:c.constraintName,columns:[{name:g,isActivated:F}],include:Y(c.include||c.indexInclude||[],_),storageParameters:c.indexStorageParameters,comment:c.indexComment,tablespace:c.indexTablespace}),"hydratePrimaryKeyOptions"),w=n((c,g)=>Object.keys(g).find(F=>g[F].GUID===c),"findName"),B=n((c,g)=>ie.get(Object.values(g).find(F=>F.GUID===c),"isActivated",!0),"checkIfActivated"),Y=n((c,g)=>ie.map(c,F=>({name:w(F.keyId,g.properties),isActivated:B(F.keyId,g.properties)})),"getKeys"),p=n(c=>Array.isArray(c.primaryKey)?c.primaryKey.filter(g=>!ie.isEmpty(g.compositePrimaryKey)).map(g=>({...l(g,null,null,c),columns:Y(g.compositePrimaryKey,c)})):[],"getCompositePrimaryKeys"),O=n(c=>Array.isArray(c.uniqueKey)?c.uniqueKey.filter(g=>!ie.isEmpty(g.compositeUniqueKey)).map(g=>({...R(g,null,null,c),columns:Y(g.compositeUniqueKey,c)})):[],"getCompositeUniqueKeys");return{getTableKeyConstraints:n(({jsonSchema:c})=>{if(!c.properties)return[];let g=a(c,([_,I])=>{if(u(I)){if(ie.isEmpty(I.primaryKeyOptions))return}else return;return l(ie.first(I.primaryKeyOptions),_,I.isActivated,c)}).filter(Boolean),F=ie.flatten(a(c,([_,I])=>{if(T(I)){if(ie.isEmpty(I.uniqueKeyOptions)||!Array.isArray(I.uniqueKeyOptions))return[]}else return[];return I.uniqueKeyOptions.map(y=>R(y,_,I.isActivated,c))})).filter(Boolean);return[...g,...p(c),...F,...O(c)]},"getTableKeyConstraints"),getClusteringKey:n(({clusteringKey:c,isParentActivated:g})=>{if(!Array.isArray(c)||c.length===0)return"";let F=n(({name:y})=>t(y),"mapName"),_=c.filter(y=>y.isActivated).map(F).join(", "),I=c.filter(y=>!y.isActivated).map(F).join(", ");return g?_.length===0?`// CLUSTER BY (${I})
`:I.length===0?`CLUSTER BY (${_})
`:`CLUSTER BY (${_}) //${I}
`:`CLUSTER BY (${c.map(F).join(", ")})
`},"getClusteringKey")}}});var $t=W((Fr,ft)=>{"use strict";var ge=require("lodash"),{preSpace:qe}=me();ft.exports=r=>{let{tab:i}=r.require("@hackolade/ddl-fe-utils").general,{toOptions:t}=oe()(r),a=n((p,O,h="")=>p!=="custom"?`(
`+i(`TYPE=${p}
${t(O)}`)+`
)`:`(
`+i(`FORMAT_NAME='${h}'`)+`
)`,"getFileFormat"),T=n(p=>ge.isEmpty(p)?"":`STAGE_COPY_OPTIONS = (
`+i(t(p))+`
)`,"getCopyOptions"),u=n((p,O)=>{let h=ge.trim(i(p.filter(N=>!!ge.trim(N,`	
 `)).join(`
`)),`	
`);return ge.trim(O)?h+`
	`+O:h},"addOptions"),R=n(p=>p.TIMESTAMP?`${p.atOrBefore} (timestamp => ${p.TIMESTAMP})`:p.OFFSET?`${p.atOrBefore} (offset => ${p.OFFSET})`:p.STATEMENT?`${p.atOrBefore} (statement => '${p.STATEMENT}')`:"","getAtOrBefore"),l=n(p=>p.map(O=>`"${O.name}"`).join(", "),"mergeKeys");function w({targetLagTimeSpan:p,targetLagAmount:O,targetLagDownstream:h}){return!(p&&O)&&!h?"":`TARGET_LAG = ${h?"DOWNSTREAM":`'${O} ${p}'`}
`}n(w,"getTargetLag");function B(p){let O=n((h,N,c)=>N===c.length-1?`	${h}`:`	${h}
`,"mapStatement");return`AS
${p.split(`
`).map(O).join("")}`}return n(B,"getSelectStatement"),{getFileFormat:a,getCopyOptions:T,addOptions:u,getAtOrBefore:R,mergeKeys:l,getTableExtraProps:n(({tableData:p,tagsStatement:O,clusterKeys:h,comment:N,dataRetentionTime:c,copyGrants:g,columnDefinitions:F})=>{if(!p.tableExtraProps)return{};let{iceberg:_,dynamic:I,transient:y,selectStatement:$,tableExtraProps:{targetLag:f,warehouse:A,refreshMode:s,initialize:S,maxDataExtensionTime:C,externalVolume:M,catalog:L,baseLocation:H}}=p;return{targetLag:w(f),warehouse:A?`WAREHOUSE = ${A}
`:"",selectStatement:$?B($):"",externalVolume:M?`EXTERNAL_VOLUME = '${M}'
`:"",catalog:L?`CATALOG = '${L}'
`:"",baseLocation:H?`BASE_LOCATION = '${H}'
`:"",column_definitions:F?`	(
		${F}
	)
`:"",refreshMode:s?`REFRESH_MODE = ${s}
`:"",initialize:S?`INITIALIZE = ${S}
`:"",clusterKeys:h,dataRetentionTime:c?`${c.trim()}
`:"",maxDataExtensionTime:C?`MAX_DATA_EXTENSION_TIME_IN_DAYS = ${C}
`:"",copyGrants:g?`${g.trim()}
`:"",comment:N?`${N.trim()}
`:"",tagsStatement:O?`${O.trim()}
`:"",transient:qe(y&&"TRANSIENT"),iceberg:qe(_&&"ICEBERG"),dynamic:qe(I&&"DYNAMIC")}},"getTableExtraProps")}}});var Pt=W((Ur,Lt)=>{"use strict";var Hn=require("lodash"),Mt=n(r=>Array.isArray(r)?r.filter(i=>i&&i.NULL_IF_item):[],"getNullIf"),Xn=n(r=>(i,t)=>{let{toString:a,toStringIfNotNone:T,toStringIfNotAuto:u,toNumber:R,toBoolean:l}=oe()(r);switch(i){case"CSV":return{COMPRESSION:t.COMPRESSION,RECORD_DELIMITER:T(t.RECORD_DELIMITER),FIELD_DELIMITER:T(t.FIELD_DELIMITER),FILE_EXTENSION:T(t.FILE_EXTENSION),SKIP_HEADER:R(t.SKIP_HEADER),DATE_FORMAT:u(t.DATE_FORMAT),TIME_FORMAT:u(t.TIME_FORMAT),TIMESTAMP_FORMAT:u(t.TIMESTAMP_FORMAT),BINARY_FORMAT:t.BINARY_FORMAT,ESCAPE:T(t.ESCAPE),ESCAPE_UNENCLOSED_FIELD:T(t.ESCAPE_UNENCLOSED_FIELD),TRIM_SPACE:l(t.TRIM_SPACE),FIELD_OPTIONALLY_ENCLOSED_BY:T(t.FIELD_OPTIONALLY_ENCLOSED_BY),NULL_IF:Hn.isEmpty(Mt(t.NULL_IF))?[]:Mt(t.NULL_IF).map(w=>a(w.NULL_IF_item)),ERROR_ON_COLUMN_COUNT_MISMATCH:l(t.ERROR_ON_COLUMN_COUNT_MISMATCH),VALIDATE_UTF8:l(t.VALIDATE_UTF8),EMPTY_FIELD_AS_NULL:l(t.EMPTY_FIELD_AS_NULL),SKIP_BYTE_ORDER_MARK:l(t.SKIP_BYTE_ORDER_MARK),ENCODING:a(t.ENCODING)};case"JSON":return{COMPRESSION:t.COMPRESSION,FILE_EXTENSION:T(t.FILE_EXTENSION),ENABLE_OCTAL:l(t.ENABLE_OCTAL),ALLOW_DUPLICATE:l(t.ALLOW_DUPLICATE),STRIP_OUTER_ARRAY:l(t.STRIP_OUTER_ARRAY),STRIP_NULL_VALUES:l(t.STRIP_NULL_VALUES),IGNORE_UTF8_ERRORS:l(t.IGNORE_UTF8_ERRORS),SKIP_BYTE_ORDER_MARK:l(t.SKIP_BYTE_ORDER_MARK)};case"AVRO":return{COMPRESSION:t.COMPRESSION};case"PARQUET":return{COMPRESSION:t.SNAPPY_COMPRESSION?void 0:t.COMPRESSION,SNAPPY_COMPRESSION:t.SNAPPY_COMPRESSION?l(t.SNAPPY_COMPRESSION):void 0,BINARY_AS_TEXT:l(t.BINARY_AS_TEXT)};case"XML":return{COMPRESSION:t.COMPRESSION,IGNORE_UTF8_ERRORS:l(t.IGNORE_UTF8_ERRORS),PRESERVE_SPACE:l(t.PRESERVE_SPACE),STRIP_OUTER_ELEMENT:l(t.STRIP_OUTER_ELEMENT),DISABLE_SNOWFLAKE_DATA:l(t.DISABLE_SNOWFLAKE_DATA),DISABLE_AUTO_CONVERT:l(t.DISABLE_AUTO_CONVERT),SKIP_BYTE_ORDER_MARK:l(t.SKIP_BYTE_ORDER_MARK)};default:return{}}},"getFormatTypeOptions");Lt.exports=Xn});var Kt=W((hr,Ft)=>{"use strict";Ft.exports=r=>{let{toNumber:i,toBoolean:t}=oe()(r),a=n(u=>u.ON_ERROR==="SKIP_FILE_<num>"?`SKIP_FILE_${u.skipFileNum}`:u.ON_ERROR==="SKIP_FILE_<num>%"?`SKIP_FILE_${u.skipFileNumPct}%`:u.ON_ERROR,"getOnError");return{getStageCopyOptions:n(u=>({ON_ERROR:a(u),SIZE_LIMIT:u.sizeLimit?i(u.SIZE_LIMIT):void 0,PURGE:t(u.PURGE),MATCH_BY_COLUMN_NAME:u.MATCH_BY_COLUMN_NAME,ENFORCE_LENGTH:t(u.ENFORCE_LENGTH),RETURN_FAILED_ONLY:t(u.RETURN_FAILED_ONLY),TRUNCATECOLUMNS:t(u.TRUNCATECOLUMNS),LOAD_UNCERTAIN_FILES:u.LOAD_UNCERTAIN_FILES?t(u.LOAD_UNCERTAIN_FILES):void 0,FORCE:t(u.FORCE)}),"getStageCopyOptions")}}});var ht=W((vr,bt)=>{"use strict";var Wn=Ye(),k=require("lodash"),{escapeString:Ut}=ye(),{preSpace:Ve}=me();bt.exports=r=>{let i=r.require("@hackolade/ddl-fe-utils").assignTemplates,t=n((N,c)=>{N=k.toUpper(N);let g=N;return u(N)&&c.timePrecision&&!k.isNaN(c.timePrecision)&&(g=`${N}(${c.timePrecision})`),["VARCHAR","STRING","TEXT","CHAR","CHARACTER"].includes(N)&&c.length&&!k.isNaN(c.length)&&(g=`${N}(${c.length})`),["NUMBER","DECIMAL","NUMERIC"].includes(N)&&!k.isNaN(c.scale)&&!k.isNaN(c.precision)&&(g=`${N}(${Number(c.precision)},${Number(c.scale)})`),g},"decorateType"),a=n(N=>["VARCHAR","STRING","TEXT","CHAR","CHARACTER"].includes(k.toUpper(N)),"isString"),T=n(N=>["NUMBER","DECIMAL","NUMERIC","INT","INTEGER","BIGINT","BYTEINT","TINYINT","SMALLINT","REAL","FLOAT","FLOAT4","FLOAT8","DOUBLE","DOUBLE PRECISION"].includes(k.toUpper(N)),"isNumber"),u=n(N=>["TIME","TIMESTAMP_NTZ","TIMESTAMP_TZ","TIMESTAMP_LTZ","TIMESTAMP","TIMESTAMPNTZ","TIMESTAMPTZ","TIMESTAMPLTZ","DATETIME"].includes(k.toUpper(N)),"isTimestamp"),R=n(N=>N.replace(/^'([\S\s]+)'$/,"$1"),"localEscapeString"),l=n(({type:N,defaultValue:c,scriptFormat:g})=>a(N)?Ut(g,R(String(c))):k.toUpper(N)==="BOOLEAN"?k.toUpper(c):c,"getDefault"),w=n((N,c,g)=>{if(!g||!T(N))return"";let F=` ${c}`;return F+=!k.isNaN(g.step)&&(g.start||g.start===0)?" START "+g.start:"",F+=!k.isNaN(g.step)&&g.step?" INCREMENT "+g.step:"",F},"getAutoIncrement"),B=n((N,c)=>!a(N)||k.isEmpty(c)?"":" COLLATE '"+Object.entries(c).map(([g,F])=>F).join("-")+"'","getCollation"),Y=n(N=>Ve(N.unique&&!N.compositeUniqueKey&&"UNIQUE"),"getUnique"),p=n(N=>!N.primaryKey||N.compositePrimaryKey?"":Ve("PRIMARY KEY"),"getPrimaryKey");return{decorateType:t,getDefault:l,getAutoIncrement:w,getCollation:B,getInlineConstraint:n(N=>p(N)+Y(N),"getInlineConstraint"),createExternalColumn:n(N=>({statement:i(Wn.externalColumnDefinition,{name:N.name,type:t(N.type,N),expression:N.expression?`(${N.expression})`:`(value:${N.name}::${N.type})`,comment:Ve(N.comment&&`COMMENT ${Ut(N.comment)}`)}),isActivated:N.isActivated}),"createExternalColumn")}}});var vt=W((Br,Yt)=>{"use strict";Yt.exports=r=>{let{foreignKeysToString:i,foreignActiveKeysToString:t,getName:a}=oe()(r);return{generateConstraint:n(({name:u,keys:R,keyType:l,isParentActivated:w,isCaseSensitive:B})=>{let Y=R.map(h=>({...h,name:`${a(B,h.name)}`})),p=Y.some(h=>h.isActivated),O=t(B,Y);return p&&w&&(O=i(B,Y)),{statement:(u!=="undefined"?`CONSTRAINT ${a(B,u)} `:"")+`${l} (${O})`,isActivated:p}},"generateConstraint")}}});var Bt=W((Vr,xt)=>{"use strict";var Ge=require("lodash"),{escapeString:zn}=ye(),{preSpace:Zn}=me();xt.exports=({getName:r,getFullName:i,templates:t,assignTemplates:a,tab:T})=>{let u=n((_,I,y)=>{let $=r(y,I),f=r(y,_);return i(f,$)},"getSchemaFullName"),R=n(({database:_,isCaseSensitive:I,newName:y}={})=>{let $=u(_,y,I);return a(t.alterSchemaScript,{name:$})},"getAlterSchemaScript"),l=n((_,{dynamic:I,database:y,isCaseSensitive:$,newName:f,schemaName:A}={})=>{let s=u(y,A,$),S=r($,f),C=i(s,S);return a(_,{dynamic:Zn(I&&"DYNAMIC"),name:C})},"getAlterEntityScript"),w=n(({script:_,data:I})=>{let{nameData:y}=I,{database:$,isCaseSensitive:f,oldName:A,nameIsChanged:s,newName:S}=y,C=u($,A,f),M=u($,S,f);if(s){let L=a(t.alterSchemaScript,{name:C});_=[..._,L+a(t.alterEntityRename,{name:M})]}return{script:_,data:I}},"getAlterSchemaName"),B={description:"COMMENT",targetLag:"TARGET_LAG",warehouse:"WAREHOUSE",DATA_RETENTION_TIME_IN_DAYS:"DATA_RETENTION_TIME_IN_DAYS",MAX_DATA_EXTENSION_TIME_IN_DAYS:"MAX_DATA_EXTENSION_TIME_IN_DAYS"},Y=n(({key:_,propValue:I,data:y},$)=>{if(_==="description"){let f=Ge.get(y,"options.targetScriptOptions.keyword");return zn(f,I)}else if(_==="targetLag"){let{targetLagAmount:f,targetLagTimeSpan:A,targetLagDownstream:s}=y[$].targetLag??{};return s?"DOWNSTREAM":`'${f} ${A}'`}return I},"getValue");return{getAlterSchemaName:w,getSetCollectionProperty:n(_=>({script:I,data:y})=>{let{setProperty:$,nameData:f}=y;if(f!=null&&f.isExternal)return{script:I,data:y};let A=Object.keys($).map((s,S)=>{let C=$[s],M=Y({key:s,data:y,propValue:C},"setProperty"),L=`${B[s]} = ${M}`;return S?T(L):L});if(!Ge.isEmpty(A)){let s=_+a(t.setPropertySchema,{property:A.join(`
`)});I=[...I,s]}return{script:I,data:y}},"getSetCollectionProperty"),getUnsetCollectionProperty:n(_=>({script:I,data:y})=>{let{unsetProperty:$,nameData:f}=y;if(f!=null&&f.isExternal)return{script:I,data:y};let A=$.map((s,S)=>(s=B[s],`${s}`));if(!Ge.isEmpty(A)){let s=_+a(t.unsetPropertySchema,{property:A.join(`
`)});I=[...I,s]}return{script:I,data:y}},"getUnsetCollectionProperty"),getSchemaMenageAccess:n(_=>({script:I,data:y})=>{let{managedAccess:$}=y;if($.isChange){let f=$.value?"ENABLE":"DISABLE";I=[...I,_+a(t.manageAccessSchema,{access:f})]}return{script:I,data:y}},"getSchemaMenageAccess"),getAlterSchemaScript:R,getAlterTableFormat:n((_,I)=>({script:y,data:$})=>{let{formatData:f,formatTypeOptions:A,nameData:s}=$;if(s.isExternal)return{script:y,data:$};let S=f.fileFormat,C=f.formatName,M=A.optionsIsChanged||f.isChangeType?A.typeOptions:{};if(f.isChangeType&&!f.fileFormat&&(S="CSV",M={}),S==="custom"&&!C)return{script:y,data:$};if(f.isChangeType||f.isChangeCustomFileFormat||A.optionsIsChanged){let L="STAGE_FILE_FORMAT = "+I(S,M||{},C);y=[...y,_+a(t.setPropertyTable,{property:L})]}return{script:y,data:$}},"getAlterTableFormat"),getAlterEntityScript:l,getAlterEntityRename:n((_,I)=>({script:y,data:$})=>{let{nameData:f}=$,{database:A,isCaseSensitive:s,oldName:S,nameIsChanged:C,newName:M,schemaName:L}=f,H=u(A,L,s),D=i(H,r(s,S)),J=i(H,r(s,M));if(C&&!f.isExternal){let Te=a(_,{name:D});y=[...y,Te+a(I,{name:J})]}return{script:y,data:$}},"getAlterEntityRename"),getAlterTableStageCopyOptions:n((_,I,y)=>({script:$,data:f})=>{let{stageCopyOptions:A,nameData:s}=f;if(A.optionsIsChanged&&!y.isEmpty(A.options)&&!(s!=null&&s.isExternal)){let S=I(A.options);$=[...$,_+a(t.setPropertyTable,{property:S})]}return{data:f,script:$}},"getAlterTableStageCopyOptions"),getAlterObjectTagsScript:n(_=>({script:I,data:y})=>{let $={tagsToSet:t.setPropertySchema,tagsToUnset:t.unsetPropertySchema};return Object.entries($).reduce((f,[A,s])=>{var M;let S=(M=f.data.tags)==null?void 0:M[A];if(!S)return f;let C=_+a(s,{property:S});return{...f,script:[...f.script,C]}},{script:I,data:y})},"getAlterObjectTagsScript")}}});var wt=W((wr,Gt)=>{"use strict";var{differenceBy:Qn,some:qt,partition:Vt,isEmpty:Ee}=require("lodash"),{preSpace:Jn}=me();Gt.exports=({getName:r,toString:i})=>{let t=n(({tags:Y,isCaseSensitive:p,indent:O=" "})=>{if(B({tags:Y}))return"";let h=T({tags:Y,isCaseSensitive:p});return Ee(h)?"":`${O}WITH TAG ( ${h} )`},"getTagStatement"),a=n(({allowedValues:Y=[]})=>{let p=Y.filter(({value:O})=>O).map(({value:O})=>i(O)).join(", ");return Jn(!Ee(p)&&`ALLOWED_VALUES ${p}`)},"getTagAllowedValues"),T=n(({tags:Y,isCaseSensitive:p})=>Y.filter(O=>O.tagName&&O.tagValue).map(O=>`${u({tagName:O.tagName,isCaseSensitive:p})} = ${i(O.tagValue)}`).join(", "),"getTagKeyValues"),u=n(({tagName:Y,isCaseSensitive:p})=>Y.split(".").map(O=>r(p||/\s/.test(O),O)).join("."),"getTagName"),R=n(({tags:Y=[],oldTags:p=[],isCaseSensitive:O=!1})=>{let[h,N]=Vt(Y,({tagName:F})=>!qt(p,{tagName:F})),c=Qn(N,p,({tagName:F,tagValue:_})=>F&&_);return Ee(h)&&Ee(c)?"":`TAG ${T({tags:[...h,...c],isCaseSensitive:O})}`},"getSetTagValue"),l=n(({tags:Y=[],oldTags:p=[],isCaseSensitive:O=!1})=>{let[h]=Vt(p,({tagName:c})=>!qt(Y,{tagName:c}));return Ee(h)?"":`TAG ${h.map(({tagName:c})=>u({tagName:c,isCaseSensitive:O})).join(", ")}`},"getUnsetTagValue"),w=n(Y=>({collection:p,data:O})=>{var I,y,$;let h=(I=p==null?void 0:p.role)==null?void 0:I.isCaseSensitive,N=(($=(y=p==null?void 0:p.role)==null?void 0:y.compMod)==null?void 0:$[Y])??{},{new:c,old:g}=N,F=R({tags:c,oldTags:g,isCaseSensitive:h}),_=l({tags:c,oldTags:g,isCaseSensitive:h});return{collection:p,data:{...O,tags:{tagsToSet:F,tagsToUnset:_}}}},"prepareObjectTagsData"),B=n(({tags:Y})=>Ee(Y)||Y.every(p=>!p.tagName),"isEmptyTags");return{getTagStatement:t,getTagAllowedValues:a,getTagKeyValues:T,prepareObjectTagsData:w,getSetTagValue:R,getUnsetTagValue:l,isEmptyTags:B}}});var K=require("lodash"),jn=tt(),Dt=rt(),V=Ye(),{LANGUAGES:Ht,FORMATS:kn}=ve(),{prepareAlterSetUnsetData:we,prepareContainerName:er,prepareMenageContainerData:tr,prepareName:De,prepareTableName:Xt,prepareCollectionFileFormat:nr,prepareCollectionFormatTypeOptions:rr,prepareCollectionStageCopyOptions:sr}=pt(),{escapeString:ce}=ye(),{joinActivatedAndDeactivatedStatements:ir}=St(),{preSpace:G}=me(),ar=1,or=1;module.exports=(r,i,t)=>{var Qe;let a=t.require("@hackolade/ddl-fe-utils").assignTemplates,{tab:T,hasType:u,clean:R}=t.require("@hackolade/ddl-fe-utils").general,l=((Qe=i==null?void 0:i.targetScriptOptions)==null?void 0:Qe.keyword)||kn.SNOWSIGHT,w=_t()(t),{getFileFormat:B,getCopyOptions:Y,addOptions:p,getAtOrBefore:O,mergeKeys:h,getTableExtraProps:N}=$t()(t),c=Pt()(t),{getStageCopyOptions:g}=Kt()(t),{toString:F,toBoolean:_,composeClusteringKey:I,foreignKeysToString:y,checkIfForeignKeyActivated:$,foreignActiveKeysToString:f,getName:A,getFullName:s,getDbName:S,viewColumnsToString:C}=oe()(t),{decorateType:M,getDefault:L,getAutoIncrement:H,getCollation:D,getInlineConstraint:J,createExternalColumn:Te}=ht()(t),{generateConstraint:pe}=vt()(t),{commentIfDeactivated:Ie}=Be(),{getAlterSchemaName:Wt,getSetCollectionProperty:Re,getUnsetCollectionProperty:Ce,getSchemaMenageAccess:zt,getAlterSchemaScript:Zt,getAlterEntityRename:He,getAlterTableFormat:Qt,getAlterTableStageCopyOptions:Jt,getAlterEntityScript:Xe,getAlterObjectTagsScript:Oe}=Bt()({getName:A,getFullName:s,templates:V,assignTemplates:a,tab:T}),{getTagStatement:_e,getTagAllowedValues:fe,getTagKeyValues:jt,prepareObjectTagsData:$e,isEmptyTags:kt}=wt()({getName:A,toString:F}),We=n((e,o=[],d=[],v=[])=>{let m=[...o,...d,...v].map(x=>e?Ie(x.statement,x):x.statement);return K.isEmpty(m)?"":`,
		`+m.join(`,
		`)},"getOutOfLineConstraints");function en(e){return e=e.replace(/^(\$\$|')/,o=>o+`
`),e=e.replace(/(\$\$|')$/,o=>`
	`+o),e}n(en,"insertNewlinesAtEdges");let Me=n(e=>G(e&&"OR REPLACE"),"getOrReplaceStatement"),ze=n(e=>e?`
	${en(ce(l,e))}`:"","getBodyStatement"),Le=n(e=>e?`
	COMMENT = '${e}'`:"","getCommentsStatement"),Ze=n(e=>e?`
	NOT NULL`:"","getNotNullStatement"),tn=n(e=>G(e&&"IF NOT EXISTS"),"getIfNotExistStatement");return{createSchema({schemaName:e,databaseName:o,transient:d,managedAccess:v,dataRetention:m,comment:x,udfs:X,procedures:E,sequences:te,fileFormats:ee,stages:z,isCaseSensitive:q,tags:ae,schemaTags:re}){let se=G(d&&"TRANSIENT"),P=!isNaN(m)&&m?`
	DATA_RETENTION_TIME_IN_DAYS=${m}`:"",U=v?`
	WITH MANAGED ACCESS`:"",j=x?`
	COMMENT=${ce(l,x)}`:"",Z=A(q,e),ne=A(q,o),Ae=s(ne,Z),Pe=a(V.createSchema,{name:Ae,transient:se,managed_access:U,data_retention:P,comment:j}),Fe=n(b=>b.map(({packageName:ue})=>`'${ue}'`).join(", "),"joinPackages"),Je=n(b=>{if(!b)return;let{language:ue,runtimeVersion:Ne,handler:Se,packages:le}=b;if([Ht.SQL,Ht.JAVASCRIPT].includes(ue))return;let Ue=Ne?`
	RUNTIME_VERSION = '${Ne}'`:"",be=Se?`
	HANDLER = '${Se}'`:"",he=le?`
	PACKAGES = (${Fe(le)})`:"";return`${Ue}${be}${he}`},"getParameters"),nn=X.map(b=>a(V.createUDF,{name:s(Z,A(q,b.name)),arguments:(b.arguments||"").replace(/^\(([\s\S]+)\)$/,"$1"),returnType:b.returnType,language:b.language,body:ze(b.function),comment:Le(b.comment),orReplace:Me(b.orReplace),parameters:Je(b),notNull:Ze(b.notNull)})),rn=E.map(({name:b,orReplace:ue,args:Ne,returnType:Se,language:le,runtimeVersion:ke,packages:Ue,handler:be,body:he,description:cn,notNull:mn})=>a(V.createProcedure,{orReplace:Me(ue),name:s(Z,A(q,b)),arguments:(Ne||"").replace(/^\(([\s\S]+)\)$/,"$1"),returnType:Se,language:le,parameters:Je({language:le,runtimeVersion:ke,handler:be,packages:Ue}),comment:Le(cn),body:ze(he),notNull:Ze(mn)})),sn=te.map(b=>a(V.createSequence,{name:s(Z,A(q,b.name)),start:b.start,increment:b.increment,comment:b.comment})),an=ee.map(b=>a(V.createFileFormat,{name:s(Z,A(q,b.name)),options:B(b.type,b.formatTypeOptions).slice(1,-1),comment:b.comment})),on=z.map(b=>a(V.createStage,{name:s(Z,A(q,b.name)),temporary:G(b.temporary&&"TEMPORARY"),url:b.url?`
	URL=${b.url}`:"",storageIntegration:b.storageIntegration?`
	STORAGE_INTEGRATION=${b.storageIntegration}`:"",credentials:b.credentials?`
	CREDENTIALS=(${b.credentials})`:"",encryption:b.encryption?`
	ENCRYPTION=(${b.encryption})`:""})),je=ae.map(b=>this.createTag({tag:b,schemaName:Z,isCaseSensitive:q}));if(!kt({tags:re})){let b=a(V.alterSchema,{name:Ae,operation:"SET TAG",options:jt({tags:re,isCaseSensitive:q})});je.push(b)}let Ke=[];return o&&Ke.push(a(V.createDatabase,{name:A(q,o)})),Ke.push(Pe),[...Ke,...nn,...rn,...sn,...an,...on,...je].join(`
`)},hydrateJsonSchemaColumn(e,o){return e.type==="variant"?K.omit(e,["subtype","mode"]):e},createTable(e,o){let d=K.get(e,"schemaData.schemaName"),v=G(e.temporary&&"TEMPORARY"),m=G(e.transient&&!e.temporary&&"TRANSIENT"),x=G(e.orReplace&&"OR REPLACE"),X=G(e.tableIfNotExists&&"IF NOT EXISTS"),E=G(!K.isEmpty(e.clusteringKey)&&"CLUSTER BY ("+(o?y(e.isCaseSensitive,e.clusteringKey):f(e.isCaseSensitive,e.clusteringKey))+")"),te=G(!K.isEmpty(e.partitioningKey)&&"PARTITION BY ("+(o?y(e.isCaseSensitive,e.partitioningKey.map(ne=>({name:`${A(e.isCaseSensitive,ne.name)}`,isActivated:ne.isActivated}))):h(e.partitioningKey))+")"),ee=G(e.comment&&`COMMENT=${ce(l,e.comment)}`),z=G(e.copyGrants&&"COPY GRANTS"),q=G(e.dataRetentionTime&&`DATA_RETENTION_TIME_IN_DAYS=${e.dataRetentionTime}`),ae=e.fileFormat?T("STAGE_FILE_FORMAT = "+B(e.fileFormat,e.formatTypeOptions,e.formatName)," "):"",re=e.fileFormat?T("FILE_FORMAT = "+B(e.fileFormat,e.formatTypeOptions,e.formatName)," "):"",se=T(Y(e.copyOptions)," "),P=T(O(e.cloneParams)," "),U=e.columns.map(ne=>Ie(ne.statement,ne)),j=ir({statements:U,indent:`
		`}),Z=_e({tags:e.tableTags,isCaseSensitive:e.isCaseSensitive});if(e.dynamic||e.iceberg){let ne=N({tableData:e,tagsStatement:Z,clusterKeys:E,comment:ee,dataRetentionTime:q,copyGrants:z,columnDefinitions:j});return a(V.createDynamicTable,{orReplace:x,tableIfNotExists:X,name:e.fullName,transient:m,...ne})}else{if(e.selectStatement)return a(V.createAsSelect,{name:e.fullName,selectStatement:e.selectStatement,tableOptions:p([E,z,Z])});if(e.cloneTableName)return a(V.createCloneTable,{name:e.fullName,source_table:s(d,e.cloneTableName),tableOptions:p([P,z,Z])});if(e.likeTableName)return a(V.createLikeTable,{name:e.fullName,source_table:s(d,e.likeTableName),tableOptions:p([E,z,Z])});if(e.external){let ne=G(e.externalOptions.location&&"WITH LOCATION="+e.externalOptions.location),Ae=G(e.externalOptions.REFRESH_ON_CREATE&&"REFRESH_ON_CREATE="+e.externalOptions.REFRESH_ON_CREATE),Pe=G(e.externalOptions.AUTO_REFRESH&&"AUTO_REFRESH="+e.externalOptions.AUTO_REFRESH),Fe=G(e.externalOptions.PATTERN&&"PATTERN="+e.externalOptions.PATTERN);return a(V.createExternalTable,{name:e.fullName,tableOptions:p([te,re,ne,Ae,Pe,Fe,z,Z],ee),orReplace:x,tableIfNotExists:X,column_definitions:j,out_of_line_constraints:We(o,e.foreignKeyConstraints,e.compositePrimaryKeys,e.compositeUniqueKeys)})}}return a(V.createTable,{name:e.fullName,temporary:v,transient:m,tableIfNotExists:X,orReplace:x,tableOptions:p([E,ae,se,q,z,Z],ee),column_definitions:j,out_of_line_constraints:We(o,e.foreignKeyConstraints,e.compositePrimaryKeys,e.compositeUniqueKeys)})},convertColumnDefinition(e){return{statement:a(V.columnDefinition,{name:e.name,type:M(e.type,e),collation:D(e.type,e.collation),default:G(!K.isUndefined(e.default)&&"DEFAULT "+L({scriptFormat:l,type:e.type,defaultValue:e.default})),autoincrement:H(e.type,"AUTOINCREMENT",e.autoincrement),identity:H(e.type,"IDENTITY",e.identity),not_nul:G(!e.nullable&&"NOT NULL"),inline_constraint:J(e),comment:G(e.comment&&`COMMENT ${ce(l,e.comment)}`),tag:_e({tags:e.columnTags,isCaseSensitive:e.isCaseSensitive})}),isActivated:e.isActivated}},createForeignKeyConstraint(e,o,d){let v=$(e),m=v?y(e.foreignTableIsCaseSensitive,e.foreignKey):f(e.foreignTableIsCaseSensitive,e.foreignKey),x=v?y(e.primaryTableIsCaseSensitive,e.primaryKey):f(e.primaryTableIsCaseSensitive,e.primaryKey);return{statement:a(V.createTableForeignKey,{constraint:e.name?`CONSTRAINT ${A(d.isCaseSensitive,e.name)} `:"",columns:m,primary_table:s(A(d.isCaseSensitive,e.primarySchemaName||d.schemaName),A(e.primaryTableIsCaseSensitive,e.primaryTable)),primary_columns:x}),isActivated:v}},createForeignKey(e,o,d){let v=$(e),m=v?y(e.foreignTableIsCaseSensitive,e.foreignKey):f(e.foreignTableIsCaseSensitive,e.foreignKey),x=v?y(e.primaryTableIsCaseSensitive,e.primaryKey):f(e.primaryTableIsCaseSensitive,e.primaryKey);return{statement:a(V.alterTableForeignKey,{constraint:e.name?`CONSTRAINT ${A(d.isCaseSensitive,e.name)} `:"",table_name:s(e.foreignSchemaName,A(e.foreignTableIsCaseSensitive,e.foreignTable)),columns:m,primary_table:s(e.primarySchemaName,A(e.primaryTableIsCaseSensitive,e.primaryTable)),primary_columns:x}),isActivated:v}},createView(e,o,d){let v=K.get(e,"schemaData.schemaName"),{columnList:m,tableColumns:x,tables:X}=e.keys.reduce((z,q)=>(z.columnList.push({name:`${A(e.isCaseSensitive,q.alias||q.name)}`,isActivated:q.isActivated}),z.tableColumns.push({name:`${A(e.isCaseSensitive,q.entityName)}.${A(e.isCaseSensitive,q.name)}`,isActivated:q.isActivated}),q.entityName&&!z.tables.includes(q.entityName)&&z.tables.push(s(q.dbName,q.entityName)),z),{columnList:[],tableColumns:[],tables:[]});if(K.isEmpty(X)&&!e.selectStatement)return"";let E=e.selectStatement||`SELECT 
	${C(x,d)}
FROM ${X.join(" INNER JOIN ")}`,te=_e({tags:e.viewTags,isCaseSensitive:e.isCaseSensitive,indent:""}),ee=e.materialized?w.getClusteringKey({clusteringKey:e.clusteringKey,isParentActivated:d}):void 0;return a(V.createView,{secure:G(e.secure&&"SECURE"),materialized:G(e.materialized&&"MATERIALIZED"),name:s(v,e.name),column_list:C(m,d),copy_grants:e.copyGrants?`COPY GRANTS
`:"",comment:e.comment?`COMMENT=${ce(l,e.comment)}
`:"",select_statement:E,tag:te?te+`
`:"",clustering:ee})},getDefaultType(e){return jn[e]},getTypesDescriptors(){return Dt},hasType(e){return u(Dt,e)},hydrateColumn({columnDefinition:e,jsonSchema:o,dbData:d}){return{...e,name:A(o.isCaseSensitive,e.name),isCaseSensitive:o.isCaseSensitive,timePrecision:Number(o.tPrecision),autoincrement:o.defaultOption==="Autoincrement"&&o.autoincrement?{start:K.get(o,"autoincrement.start_num"),step:K.get(o,"autoincrement.step_num")}:!1,identity:o.defaultOption==="Identity"&&o.identity?{start:K.get(o,"identity.start_num"),step:K.get(o,"identity.step_num")}:!1,collation:o.collate?R({locale:o.locale,caseSensitivity:o.caseSensitivity,accentSensitivity:o.accentSensitivity,punctuationSensitivity:o.punctuationSensitivity,firstLetterPreference:o.firstLetterPreference,caseConversion:o.caseConversion,spaceTrimming:o.spaceTrimming}):{},comment:o.refDescription||o.description,unique:o.uniqueKeyConstraintName?!1:o.unique,primaryKeyConstraintName:o.primaryKeyConstraintName,compositePrimaryKey:o.compositePrimaryKey||o.primaryKeyConstraintName&&o.primaryKey,compositeUniqueKey:o.compositeUniqueKey||o.uniqueKeyConstraintName&&o.unique,uniqueKeyConstraintName:o.uniqueKeyConstraintName,primaryKey:o.primaryKeyConstraintName?!1:e.primaryKey,expression:o.expression,columnTags:o.columnTags??[]}},hydrateSchema(e,{udfs:o,procedures:d,sequences:v,fileFormats:m,stages:x,tags:X}={}){return{schemaName:A(e.isCaseSensitive,e.name),isCaseSensitive:e.isCaseSensitive,databaseName:e.database,comment:e.description,transient:e.transient,managedAccess:e.managedAccess,dataRetention:e.DATA_RETENTION_TIME_IN_DAYS,schemaTags:e.schemaTags,udfs:Array.isArray(o)?o.map(E=>R({name:E.name||void 0,orReplace:E.functionOrReplace||void 0,language:E.functionLanguage||E.storedProcLanguage||void 0,runtimeVersion:E.functionRuntimeVersion||void 0,packages:E.functionPackages||void 0,arguments:E.functionArguments||E.storedProcArgument||void 0,returnType:E.functionReturnType||E.storedProcDataType||void 0,notNull:E.functionNotNull||void 0,handler:E.functionHandler||void 0,function:E.functionBody||E.storedProcFunction?T(K.trim(E.functionBody||E.storedProcFunction)):void 0,comment:E.functionDescription||E.storedProcDescription?`${E.functionDescription||E.storedProcDescription}`:""})).filter(E=>E.name&&E.language&&E.returnType&&E.function):[],procedures:Array.isArray(d)?d.map(E=>R({name:E.name||void 0,orReplace:E.orReplace||void 0,args:E.inputArgs||void 0,returnType:E.returnType||void 0,notNull:E.notNull||void 0,language:E.language||void 0,runtimeVersion:E.runtimeVersion||void 0,packages:E.packages||void 0,handler:E.handler||void 0,body:E.body?T(K.trim(E.body)):void 0,description:E.description||void 0})).filter(E=>E.name):[],sequences:Array.isArray(v)?v.map(E=>R({name:E.name||void 0,start:E.sequenceStart||ar,increment:E.sequenceIncrement||or,comment:G(E.sequenceComments&&`COMMENT=${ce(l,E.sequenceComments)}`)})).filter(E=>E.name):[],fileFormats:Array.isArray(m)?m.map(E=>R({name:E.name||void 0,type:E.fileFormat,formatTypeOptions:R(c(E.fileFormat,E.formatTypeOptions)),comment:G(E.fileFormatComments&&`COMMENT=${ce(l,E.fileFormatComments)}`)})).filter(E=>E.name):[],stages:Array.isArray(x)?x.map(E=>R({name:E.name||void 0,temporary:E.temporary,url:E.url,storageIntegration:E.storageIntegration,credentials:E.credentials,encryption:E.encryption})).filter(E=>E.name):[],tags:Array.isArray(X)?X.map(E=>R({name:E.name||void 0,orReplace:E.orReplace||void 0,ifNotExist:E.ifNotExist||void 0,allowedValues:E.allowedValues||void 0,description:E.description||void 0})).filter(E=>E.name):[]}},hydrateTable({tableData:e,entityData:o,jsonSchema:d}){let v=w.getTableKeyConstraints({jsonSchema:d}),m=K.get(o,"[0]",{}),x=A(m.isCaseSensitive,K.get(e,"schemaData.schemaName")),X=A(m.isCaseSensitive,K.get(e,"schemaData.databaseName")),E=A(m.isCaseSensitive,e.name),te=s(X,s(x,E)),ee=n(P=>P.namespace?P.namespace+P.path:P.path,"getLocation"),z=m.external?m.externalFileFormat:m.fileFormat,q=v.filter(({keyType:P})=>P==="PRIMARY KEY").reduce((P,U)=>({...P,[U.name]:U.columns.map(j=>({name:j.name,isActivated:j.isActivated}))}),{}),ae=v.filter(({keyType:P})=>P==="UNIQUE").reduce((P,U)=>({...P,[U.name]:U.columns.map(j=>({name:j.name,isActivated:j.isActivated}))}),{}),re=e.columnDefinitions.filter(P=>P.compositePrimaryKey).reduce((P,U)=>U.primaryKeyConstraintName?{...P,[U.primaryKeyConstraintName]:Array.isArray(P[U.primaryKeyConstraintName])?K.uniqBy([...P[U.primaryKeyConstraintName],{name:U.name,isActivated:U.isActivated}],"name"):[{name:U.name,isActivated:U.isActivated}]}:P,q),se=e.columnDefinitions.filter(P=>P.compositeUniqueKey).reduce((P,U)=>U.uniqueKeyConstraintName?{...P,[U.uniqueKeyConstraintName]:Array.isArray(P[U.uniqueKeyConstraintName])?K.uniqBy([...P[U.uniqueKeyConstraintName],{name:U.name,isActivated:U.isActivated}],"name"):[{name:U.name,isActivated:U.isActivated}]}:P,ae);return{...e,fullName:te,name:A(m.isCaseSensitive,e.name),temporary:m.temporary,transient:m.transient,external:m.external,dynamic:m.dynamic,iceberg:m.iceberg,orReplace:m.orReplace,tableIfNotExists:m.tableIfNotExists,tableExtraProps:{warehouse:m.warehouse,targetLag:m.targetLag,refreshMode:m.refreshMode,initialize:m.initialize,query:m.query,externalVolume:m.externalVolume,catalog:m.catalog,baseLocation:m.baseLocation,maxDataExtensionTime:isNaN(m.MAX_DATA_EXTENSION_TIME_IN_DAYS)?"":m.MAX_DATA_EXTENSION_TIME_IN_DAYS},selectStatement:m.selectStatement,isCaseSensitive:m.isCaseSensitive,clusteringKey:Array.isArray(m.clusteringKey)?m.clusteringKey.map(P=>I(m.isCaseSensitive,d,P)).filter(Boolean):[],partitioningKey:m.partitioningKey,comment:m.description,copyGrants:m.copyGrants,dataRetentionTime:isNaN(m.DATA_RETENTION_TIME_IN_DAYS)?"":m.DATA_RETENTION_TIME_IN_DAYS,fileFormat:z,formatName:m.customFileFormatName,formatTypeOptions:K.isEmpty(m.formatTypeOptions)?{}:R(c(z,m.formatTypeOptions)),copyOptions:K.isEmpty(m.stageCopyOptions)?{}:R(g(m.stageCopyOptions)),cloneTableName:A(m.isCaseSensitive,K.get(e,`relatedSchemas[${m.clone}].code`,"")),likeTableName:A(m.isCaseSensitive,K.get(e,`relatedSchemas[${m.like}].code`,"")),cloneParams:K.isEmpty(m.cloneParams)?{}:{atOrBefore:K.toUpper(m.cloneParams.atOrBefore),TIMESTAMP:m.cloneParams.TIMESTAMP,OFFSET:m.cloneParams.OFFSET,STATEMENT:m.cloneParams.STATEMENT},externalOptions:{location:K.isPlainObject(m.location)?ee(m.location):"",REFRESH_ON_CREATE:_(m.REFRESH_ON_CREATE),AUTO_REFRESH:_(m.AUTO_REFRESH),PATTERN:m.PATTERN?F(m.PATTERN):""},columns:m.external?e.columnDefinitions.map(Te):e.columns,compositePrimaryKeys:Object.entries(re).map(([P,U])=>pe({name:P,keys:U,keyType:"PRIMARY KEY",isActivated:d.isActivated,isCaseSensitive:m.isCaseSensitive})),compositeUniqueKeys:Object.entries(se).map(([P,U])=>pe({name:P,keys:U,keyType:"UNIQUE",isActivated:d.isActivated,isCaseSensitive:m.isCaseSensitive})),tableTags:m.tableTags??[]}},hydrateView({viewData:e,entityData:o}){let d=o[0],{databaseName:v,schemaName:m}=e.schemaData,x=A(d.isCaseSensitive,e.name),X=s(v,s(m,x));return{...e,name:A(d.isCaseSensitive,e.name),selectStatement:d.selectStatement,isCaseSensitive:d.isCaseSensitive,copyGrants:d.copyGrants,comment:d.description,secure:d.secure,materialized:d.materialized,fullName:X,clusteringKey:d.clusteringKey,viewTags:d.viewTags??[]}},hydrateViewColumn(e){var o,d,v;return e.entityName?{...e,name:A((o=e.definition)==null?void 0:o.isCaseSensitive,e.name),dbName:A((d=K.first(e.containerData))==null?void 0:d.isCaseSensitive,e.dbName),entityName:A((v=K.first(e.entityData))==null?void 0:v.isCaseSensitive,e.entityName)}:e},commentIfDeactivated(e,o,d){return Ie(e,o,d)},alterTable(e){if(e.iceberg)return"// Dynamic Iceberg tables are currently only supported for CREATE statements. Specifying DYNAMIC ICEBERG in any other command (for example, ALTER DYNAMIC ICEBERG TABLE <name>) results in an error.";let o=Xe(V.alterTableScript,{dynamic:e.dynamic,...e.nameData}),{script:d}=K.flow(He(V.alterTableScript,V.alterEntityRename),Re(o),Ce(o),Qt(o,B),Jt(o,Y,K),Oe(o))({data:e,script:[]});return d.join(`
`)},hydrateAlertTable(e){var v,m,x,X;let{data:o}=K.flow(De,Xt,nr,rr,we,sr(R,g,K),$e("tableTags"))({collection:e,data:{}}),d=R(c(o.formatData.fileFormat,o.formatTypeOptions.typeOptions));return{...o,dynamic:e.role.dynamic,iceberg:((m=(v=e.compMod)==null?void 0:v.iceberg)==null?void 0:m.old)||((X=(x=e.compMod)==null?void 0:x.iceberg)==null?void 0:X.new),formatTypeOptions:{...o.formatTypeOptions,typeOptions:d}}},alterView(e){let{nameData:o}=e,d=o.isMaterialized?"alterMaterializedViewScript":"alterViewScript",v=Xe(V[d],o),{script:m}=K.flow(He(V[d],V.alterEntityRename),Re(v),Ce(v),Oe(v))({data:e,script:[]});return m.join(`
`)},hydrateAlterView(e){let{data:o}=K.flow(De,Xt,we,$e("viewTags"))({collection:e,data:{}});return o},alterSchema(e){let o=Zt(e==null?void 0:e.nameData),{script:d}=K.flow(Wt,Re(o),Ce(o),zt(o),Oe(o))({data:e,script:[]});return d.join(`
`)},hydrateAlterSchema(e){return K.flow(De,er,we,tr,$e("schemaTags"))({collection:e,data:{}}).data},hydrateForDeleteSchema(e){let o=A(e.isCaseSensitive,S(e)),d=A(e.isCaseSensitive,e.database);return{name:s(d,o)}},dropSchema({name:e}){return a(V.dropSchema,{name:e})},createTag({tag:e,schemaName:o,isCaseSensitive:d}){return a(V.createTag,{orReplace:Me(e.orReplace),ifNotExist:tn(e.ifNotExist),allowedValues:fe({allowedValues:e.allowedValues}),name:s(o,A(d,e.name)),comment:Le(e.description)})},dropTag({tag:e,schemaName:o,isCaseSensitive:d}){return a(V.dropTag,{name:s(o,A(d,e.name))})},alterTag({tag:e,oldTag:o,schemaName:d,isCaseSensitive:v}){let m=s(d,A(v,o.name)),x=s(d,A(v,e.name)),X=K.flatMap(e.allowedValues,({value:U})=>U).filter(Boolean),E=K.flatMap(o.allowedValues,({value:U})=>U).filter(Boolean),te=K.differenceBy(e.allowedValues,o.allowedValues,({value:U})=>U),ee=K.differenceBy(o.allowedValues,e.allowedValues,({value:U})=>U),z=m!==x,q=o.description&&!e.description,ae=!q&&e.description!==o.description,re=E.length&&!X.length,se=[],P=n((U,j)=>{if(U){let Z=a(V.alterTag,j);se.push(Z)}},"createAndPushStatement");return P(z,{ifExists:G("IF EXISTS"),name:m,option:"RENAME TO ",optionValue:A(v,e.name)}),P(re,{name:x,option:"UNSET ALLOWED_VALUES"}),P(!re&&!K.isEmpty(ee),{ifExists:G("IF EXISTS"),name:x,option:"DROP",optionValue:fe({allowedValues:ee})}),P(!K.isEmpty(te),{ifExists:G("IF EXISTS"),name:x,option:"ADD",optionValue:fe({allowedValues:te})}),P(q,{ifExists:G("IF EXISTS"),name:x,option:"UNSET COMMENT"}),P(ae,{ifExists:G("IF EXISTS"),name:x,option:"SET COMMENT = ",optionValue:F(e.description)}),se.join("")}}};
